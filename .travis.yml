language: node_js
node_js:
  - 12
services:
  - docker
env:
  global:
    - PROJECT_NAME=koseseg
    - REGISTRY_HOST_NAME=eu.gcr.io
cache:
  directories:
    - "$HOME/.cache/yarn"
    - node_modules
    - ".next/cache"

before_install:
  - openssl aes-256-cbc -K $encrypted_241002f0ef4b_key -iv $encrypted_241002f0ef4b_iv -in keyfile.json.enc -out keyfile.json -d

script:
  - npm run build
  - echo "Skipping tests"

deploy:
  skip_cleanup: true
  provider: script
  script: bash scripts/travis_deploy
  on:
    branch: master
